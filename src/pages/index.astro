---
// 最新のブログ記事を取得
import { getCollection } from 'astro:content';
import Layout from '../layouts/Layout.astro';
import Section from '../components/ui/Section.astro';
import Slideshow from '../components/ui/Slideshow.astro';

// 最新のブログ記事を6件取得（スライドショー用）
const recentPosts = await getCollection('blog', ({ data }) => {
  return import.meta.env.PROD ? data.draft !== true : true;
}).then(posts => posts.sort((a, b) => new Date(b.data.pubDate).valueOf() - new Date(a.data.pubDate).valueOf()).slice(0, 6));

// スライドショー用のデータに変換
const slides = recentPosts.map((post) => ({
  title: post.data.title,
  description: post.data.description,
  image: post.data.heroImage || post.data.image || '/images/default-blog-hero.jpg', // サムネイル画像
  link: `/blog/${post.slug}`,
  linkText: '記事を読む',
  pubDate: new Date(post.data.pubDate),
  tags: post.data.tags
}));
---

<Layout title="ようかん - ホーム" description="ようかんのサイトです。技術ブログや最新記事をチェックできます。">
  
  
  <!-- 最新記事カードスタック -->
  <Section background="white" padding="lg">
    <Slideshow 
      slides={slides}
      size="md"
      autoPlay={true}
      autoPlayInterval={6000}
    />
  </Section>
</Layout> 